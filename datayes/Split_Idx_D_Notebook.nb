df_secid=DataAPI.IdxGet(secID=u"",indexGroup=u"",consType=u"",consMkt=u"",returnType=u"",       indexTypeCD=u"",porgFullName=u"",secShortName=u"",wMethodCD="",pubName=u"",industryID=u"",sortID=u"",pandas="1")
sizeCount = 0
need_header=True
# # print(df)
# df.to_csv("fund_etf.csv", encoding="gbk")

for secID in df_secid['secID']:
    print (secID)
    df = DataAPI.MktIdxdGet(indexID=secID,beginDate=u"19900101",endDate=u"20220201",exchangeCD=u"XSHE,XSHG",field=u"",pandas="1")
# print(df)
    sizeCount=sizeCount+df.size
    if sizeCount >1000000:
        # print ("Size is about 100M, Start to new file since secID: " + secID)
        # count=count+1
        need_header=True
        break
    df.to_csv("mkt_idx_d_test.csv", mode='a', header=need_header, encoding="gbk")
    need_header=False
